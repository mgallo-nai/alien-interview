<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Alien Interview â€” 8 Species, 7 Characteristics (All Clear + Debug)</title>
<style>
  :root{--bg:#0b1020; --panel:#131a33; --text:#eef2ff; --accent:#7cf7d4; --muted:#93a1b3;}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#060a18,#0b1020 30%,#0e1833);color:var(--text)}
  header{padding:16px 20px;border-bottom:1px solid #1f2748;background:#0a1330;position:sticky;top:0}
  header h1{margin:0;font-size:1.05rem}
  #app{max-width:980px;margin:0 auto;padding:16px}
  .chat{background:var(--panel);border:1px solid #1f2748;border-radius:14px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .spec{padding:12px 14px;border-bottom:1px solid #1f2748;background:#0b1530}
  .spec h2{margin:0 0 6px 0;font-size:1.15rem}
  .spec .meta{font-size:.9rem;color:#b3c4e0;line-height:1.5}
  .status{padding:6px 14px;background:#0b1530;font-size:.82rem;color:#7cf7d4;border-bottom:1px solid #1f2748}
  .log{height:min(64vh,600px);overflow:auto;padding:18px;scroll-behavior:smooth}
  .msg{display:flex;gap:12px;margin:10px 0;align-items:flex-start}
  .msg .bubble{max-width:820px;padding:12px 14px;border-radius:12px;line-height:1.45}
  .user .bubble{background:#23305f}
  .alien .bubble{background:#0f2347;border:1px solid #253a7a}
  .role{font-size:.75rem;color:var(--muted);margin-bottom:4px}
  .inputbar{display:flex;gap:10px;padding:12px;border-top:1px solid #1f2748;background:#0c1735}
  input[type="text"]{flex:1;padding:12px 14px;border-radius:10px;border:1px solid #28345f;background:#0f1a3a;color:#eef2ff}
  input::placeholder{color:#96a2c3}
  button{background:var(--accent);color:#04131a;border:none;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer}
  button:disabled{background:#374151;color:#888;cursor:not-allowed}
  .footer{font-size:.75rem;color:#94a3b8;text-align:center;margin:16px 0 8px}
  .debugNote{color:#7cf7d4;font-size:.75rem;margin:4px 0 0 0;opacity:0.9}
</style>
</head>
<body>
<header><h1>ðŸ‘½ Alien Interview Console</h1></header>

<div id="app">
  <div class="chat">
    <div id="spec" class="spec"></div>
    <div id="status" class="status"></div>
    <div id="log" class="log" aria-live="polite"></div>
    <div class="inputbar">
      <input id="textbox" type="text" placeholder="Type your questionâ€¦" />
      <button id="send">Send</button>
    </div>
  </div>
  <div class="footer">You may ask <b>3 valid questions</b>. Use the visitorâ€™s responses as evidence for your claim.</div>
</div>

<script>
/* ================= helpers ================= */
const q=new URLSearchParams(location.search);
const debugMode = q.get('debug') === 'true';
const pick=a=>a[Math.floor(Math.random()*a.length)];
const rand=(min,max)=>Math.floor(Math.random()*(max-min+1))+min;
const varify=s=>s.replace(/\{mins\}/g,()=>rand(2,8)).replace(/\{days\}/g,()=>rand(3,7)).replace(/\{mm\}/g,()=>rand(2,12));
const C=t=>({text:t,clarity:'clear'});
const cap=s=>s.charAt(0).toUpperCase()+s.slice(1);

/* ================= guard lists ================= */
const NEVERSAY=['alive','are you alive','is it alive','are you living','living or nonliving'];
const DEFLECTS=[
  "Please do not ask if I am alive. Ask about how I function and what I do.",
  "Labels are not evidence. Ask about my needs, how I change, whether I have young, how I respond, and how I keep functioning."
];
const CLARIFY=[
  "I did not understand. Try asking me how I function or what I do. Please do not ask me directly if I am alive.",
  "Iâ€™m not sure what you mean. Please rephrase your question in a different way.",
  "I don't understand. Try asking a more specific question about how I function."
];

/* ================= keyword routing ================= */
const K = {
  stimuli: ['respond to environment','respond to change','stimulus','response','respond'],
  growth: ['get bigger','change size','change form','metamorphosis','differentiate','grow','develop','growth','development'],
  repro:  ['sexually reproduce','asexually reproduce','make more of your kind','reproduce','reproduction'],
  energy: ['photosynthesis','metabolize','metabolism','calories','nutrition','nutrients','eat','food','energy'],
  genetic:['use dna to make proteins','genetic code','use dna','dna','make proteins'],
  homeo:  ['regulate body temperature','regulate blood sugar','regulate oxygen','regulate gasses','keep body conditions stable','maintain','regulation','homeostasis'],
  cells:  ['organ systems','organ','organs','tissues','contain organelles','made of cells','multicellular','unicellular'],
  evo:    ['common ancestor','species change','change over time','offspring better','fossil','evolution','evolve','generations']
};
const LABELS = {
  stimuli:'Respond to Environment', growth:'Grow & Develop', repro:'Reproduction', energy:'Obtain & Use Energy',
  genetic:'Universal Genetic Code', homeo:'Maintain Homeostasis', cells:'Made of Cells', evo:'Evolve'
};
const PRIORITY = ['stimuli','homeo','energy','growth','repro','cells','genetic','evo'];

function bestCategory(text){
  const s = text.toLowerCase();
  if(NEVERSAY.some(w=>s.includes(w))) return 'deflect';
  let best = {cat:null,len:0};
  for(const cat of Object.keys(K)){
    for(const phrase of K[cat]){
      const p = phrase.toLowerCase();
      if(s.includes(p) && p.length > best.len){ best = {cat,len:p.length}; }
    }
  }
  if(!best.cat) return 'clarify';
  const matches=[];
  for(const cat of Object.keys(K)){
    for(const phrase of K[cat]){
      const p = phrase.toLowerCase();
      if(s.includes(p) && p.length===best.len) matches.push(cat);
    }
  }
  if(matches.length===1) return best.cat;
  for(const p of PRIORITY){ if(matches.includes(p)) return p; }
  return best.cat;
}

/* ================= alien profiles ================= */
const PROFILES=[
  // ... [Aliens 1â€“6 unchanged] ...
  { id:'7', name:'Mire Crawler', world:'Vorsass',
    look:'I am a slug-like scavenger with small bristles on my sides. I function in warm, poisonous swamps and often leave a thick paste trail behind me.',
    energy:{src:'rotting plants and swamp slurry',trigger:'feeding on rot',measure:'body warmth and crawl speed',activity:'crawl faster',alt:'metal salts in the muck'},
    growth:{marker:'a shed skin after each molt',heal:'fresh skin covers scars',regrow:'lost feelers grow back'},
    repro:{mode1:'slimy strings later open with tiny ones',mode2:'twisting a neck frill with a partner leads to eggs by dawn'},
    cells:{feature:'detox pockets and tiny beads under the skin',flow:'valve areas that gate poisons in the gut lining'},
    stimuli:{s1:{stim:'touch on my flank',resp:'I twitch away immediately'}, s2:{stim:'rot scent',resp:'I move toward it; sharp smoke sends me under'}},
    homeo:{cold:'chill makes me clump and shiver',heat:'heat makes me spread slime to cool',salt:'salt flushes through side pores when brine rises'},
    genetic:{info:'coded beads sit in each tiny room',proof:'when a beadâ€™s order changes, the next shell patch forms a new pattern'},
    evo:{sel1:'lines rich in detox helpers persisted where others perished',sel2:'thicker slime coats spread in hotter marshes'}
  },
  // ... [Alien 8 unchanged] ...
];

/* ================= replies & UI functions unchanged ================= */
</script>
</body>
</html>
